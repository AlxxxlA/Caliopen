---
passwords_reset:
  post:
    description: Route to receive a "reset password" request from an anonymous user.
    tags:
    - passwords
    security: []
    consumes:
    - application/json
    parameters:
    - name: reset_request
      in: body
      required: true
      description: data the user has typed into the reset form
      schema:
        type: object
        properties:
          recovery_email:
            type: string
          username:
            type: string
        additionalProperties: false
        required :
        - recovery_email
    produces:
    - application/json
    responses:
      '204':
        description: Request successfully handled. No body is returned.
      '400':
        description: malform request
        schema:
          type: object
          "$ref": "../objects/Error.yaml"
      '404':
        description: user not found
        schema:
          "$ref": "../objects/Error.yaml"
      '424':
        description: Parameters were valid but the server was unable to handle the request.
        schema:
          type: object
          "$ref": "../objects/Error.yaml"
passwords_reset_{token}:
  get:
    description: Returns an auth token to build basicAuth, if the token in path is valid
    tags:
    - passwords
    security: []
    parameters:
    - name: token
      in: path
      required: true
      type: string
    produces:
    - application/json
    responses:
        '200':
          description: Successful request on a valid temporary route.
          schema:
            type: object
            properties:
              temp_username:
                type: string
                description: temp_username makes the 'username' for basicAuth
              temp_password:
                type: string
                description: temp_password makes the 'password' for basicAuth
            additionalProperties: false
          '404':
            description: reset route not found or expired
            schema:
              "$ref": "../objects/Error.yaml"
  post:
    description: User posts a new password
    tags:
    - passwords
    security:
    - basicAuth: []
    consumes:
    - application/json
    parameters:
    - name: new_password
      in: body
      required: true
      description:
      schema:
        type: object
        properties:
          password:
            type: string
        additionalProperties: false
        required :
        - password
    responses:
      '204':
        description: Password update successful. No body is returned.
      '400':
        description: malform request
        schema:
          type: object
          "$ref": "../objects/Error.yaml"
      '401':
        description: Unauthorized access
        schema:
          "$ref": "../objects/Error.yaml"
      '424':
        description: Parameters were valid but the server was unable to change the password.
        schema:
          type: object
          "$ref": "../objects/Error.yaml"